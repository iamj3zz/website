# Lefthook Configuration
# Fast and powerful Git hooks manager
# https://github.com/evilmartians/lefthook
#
# IMPORTANT: This project relies on LOCAL TESTING ONLY.
# GitHub Actions only builds and deploys - it does NOT run tests.
# These hooks are your ONLY safety net to prevent breaking changes.

# Pre-commit: Run COMPLETE test suite before EVERY commit
# This is MANDATORY - blocks commits if any test fails
# Ensures you never commit broken code
pre-commit:
  commands:
    full-tests:
      run: ./test-before-push.sh
      fail_text: |
        ❌ Tests failed! Commit blocked.

        Your changes contain errors that must be fixed before committing.

        Fix the errors above, then try committing again.

        To run tests manually:
          ./test-before-push.sh

# Pre-push: Run optional Lighthouse CI before pushing
# Lighthouse tests are comprehensive but slow (~1-2 min)
# Run for major releases or when testing performance changes
pre-push:
  commands:
    lighthouse-optional:
      run: |
        echo ""
        echo "✨ Pre-commit tests already passed. Running optional Lighthouse CI..."
        echo ""
        echo "Skipping Lighthouse (too slow for regular pushes)."
        echo "To run Lighthouse: ./test-before-push.sh --full"
        echo ""
      fail_text: |
        ℹ️  This is informational only. Push will proceed.

# ⚠️  CRITICAL: Do NOT skip hooks unless absolutely necessary!
#
# GitHub Actions does NOT run tests - only local hooks do.
# Skipping these hooks may result in deploying broken code.
#
# To skip hooks (use with extreme caution):
#   LEFTHOOK=0 git push
#   or
#   git push --no-verify
#
# Only skip if:
#   - You already ran ./test-before-push.sh manually and all tests passed
#   - You're pushing non-code changes (docs only, etc.)
#   - You know exactly what you're doing
