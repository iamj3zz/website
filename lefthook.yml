# Lefthook Configuration
# Fast and powerful Git hooks manager
# https://github.com/evilmartians/lefthook
#
# IMPORTANT: This project relies on LOCAL TESTING ONLY.
# GitHub Actions only builds and deploys - it does NOT run tests.
# These hooks are your ONLY safety net to prevent breaking changes.

# Pre-commit: Run quick checks before committing
# Blocks commits if YAML validation fails
pre-commit:
  parallel: true
  commands:
    yaml-lint:
      glob: "*.{yml,yaml}"
      run: yamllint {staged_files}
      stage_fixed: true
      fail_text: "❌ YAML validation failed. Fix the errors above before committing."

# Pre-push: Run COMPLETE test suite before pushing
# This is MANDATORY - GitHub Actions will not catch test failures!
# Blocks push if any test fails (YAML, build, HTML, print tests)
pre-push:
  commands:
    full-tests:
      run: ./test-before-push.sh
      fail_text: |
        ❌ Tests failed! Push blocked.

        Fix the errors above, then run again:
          ./test-before-push.sh

        Once all tests pass, try pushing again.

# ⚠️  CRITICAL: Do NOT skip hooks unless absolutely necessary!
#
# GitHub Actions does NOT run tests - only local hooks do.
# Skipping these hooks may result in deploying broken code.
#
# To skip hooks (use with extreme caution):
#   LEFTHOOK=0 git push
#   or
#   git push --no-verify
#
# Only skip if:
#   - You already ran ./test-before-push.sh manually and all tests passed
#   - You're pushing non-code changes (docs only, etc.)
#   - You know exactly what you're doing
